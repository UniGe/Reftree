<h3>Users</h3>
<div class="row">
    <div class="col-md-6">
        <div style="height:10px"></div>
        <div class="btn btn-success"
             ng-click="gu.userInEdit = {}">
            <i class="fa fa-plus"></i>
        </div>
        <div class="btn btn-danger"
             ng-show="gu.userInEdit"
             ng-click="gu.userInEdit = null">
            <i class="fa fa-times" aria-hidden="true"></i>
        </div>
        <div style="height:10px"></div>
        <div ng-if="gu.userInEdit">
            <form name="gu.$userForm">
                <div class="form-inline">
                    <div class="form-group">
                        <label>Username</label>
                        <input class="form-control" ng-model="gu.userInEdit.username" required ng-readonly="gu.userInEdit.id" />
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input class="form-control" ng-model="gu.userInEdit.password" />
                    </div>
                </div>
                <div class="form-group">
                    <label>Applications</label>
                    <search-drop sd-values="gu.applications"
                                 sd-close-drop-after="750"
                                 sd-height="150px"
                                 sd-value="$$value"
                                 sd-label="application_name"
                                 sd-max-drop-height="200px"
                                 sd-onselect="gu.selectApplication(selectedKey)"
                                 sd-stay-open="true"></search-drop>
                    <div ng-repeat="application in gu.userInEdit.applications track by application.id">
                        <div class="form-inline" style="margin-top: 10px">
                            <div class="form-group">
                                <label>Application name</label>
                                <input class="form-control" ng-model="application.application_name" readonly disabled />
                            </div>
                            <div class="form-group">
                                <label>Application host</label>
                                <input class="form-control" ng-model="application.host" readonly disabled />
                            </div>
                            <div class="form-group">
                                <label>User path</label>
                                <input class="form-control" ng-model="application.path" />
                            </div>
                            <div class="form-group">
                                <label>
                                    Active
                                    <input type="checkbox" ng-model="application.active" />
                                </label>
                            </div>
                            <!--<div class="form-group">
                                <label>Application path</label>
                                <input class="form-control" ng-model="application.application_path" readonly disabled />
                            </div>
                            <div class="form-group">
                                <label>Application active</label>
                                <input type="checkbox" ng-model="application.application_active" disabled />
                            </div>-->
                            <div style="margin-left: 10px"
                                 class="btn btn-danger"
                                 ng-click="gu.userInEdit.applications.splice($index, 1)">
                                <i class="fa fa-times" aria-hidden="true"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="btn btn-success"
                     ng-click="gu.saveUser(gu.userInEdit)"><i class="fa fa-floppy-o" aria-hidden="true"></i></div>
            </form>
        </div>
        <h3>Applications</h3>
        <div class="btn btn-success"
             ng-click="gu.applicationsEditable.push({ application_active: true })">
            <i class="fa fa-plus"></i>
        </div>
        <div 
             ng-repeat="application in gu.applicationsEditable"
             ng-form="application.$form"
             class="form-inline"
        >
            <div class="form-group">
                <label>Application name</label>
                <input class="form-control" ng-model="application.application_name" required />
            </div>
            <div class="form-group">
                <label>Application host</label>
                <input class="form-control" ng-model="application.host" required />
            </div>
            <div class="form-group">
                <label>Application path</label>
                <input class="form-control" ng-model="application.application_path" />
            </div>
            <div class="form-group">
                <label>
                    Active
                    <input type="checkbox" ng-model="application.application_active" />
                </label>
            </div>
            <div style="margin-left: 10px"
                    class="btn btn-success"
                    ng-click="gu.saveApplication(application)">
                <i class="fa fa-floppy-o" aria-hidden="true"></i>
            </div>
            <div style="margin-left: 10px"
                    class="btn btn-danger"
                    ng-click="gu.deleteApplication(application)">
                <i class="fa fa-times" aria-hidden="true"></i>
            </div>
        </div>
        <div style="height:10px"></div>
    </div>
    <div class="row col-md-6">
        <div class="col-md-12">
            <input class="form-control"
                   placeholder="Search user..."
                   ng-model="gu.searchTerm"
                   ng-change="gu.search()" />
        </div>
        <div class="animate-user col-md-4"
             style="margin-top: 10px"
             ng-repeat="user in gu.users track by user.id">
            <div class="btn btn-default"
                 style="width: 100%"
                 ng-click="gu.userInEdit = user; gu.setUserInEditPermissions(user)">
                {{user.username}}
                <i class="fa fa-trash pull-right"
                   ng-click="gu.deleteUser(user); $event.stopPropagation();"></i>
            </div>
        </div>
        <div style="margin-top: 10px;" class="col-md-offset-3 col-md-6 alert alert-warning" ng-show="!gu.users.length">No user found...</div>
    </div>
</div>


<style>
    .animate-user.ng-enter, 
    .animate-user.ng-leave { 
        -webkit-transition: 400ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;
        -moz-transition: 400ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;
        -ms-transition: 400ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;
        -o-transition: 400ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;
        transition: 400ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;
        position: relative;
        display: block;
    } 

    .animate-user.ng-leave.ng-leave-active,
    .animate-user.ng-enter {
        -webkit-transform: rotateX(-180deg) translatez(30px);
        -moz-transform: rotateX(-180deg) translatez(30px);
        -ms-transform: rotateX(-180deg) translatez(30px);
        -o-transform: rotateX(-180deg) translatez(30px);
        transform: rotateX(-180deg) translatez(30px);
        opacity: 0;
        height: 0px;
    }        

    .animate-user.ng-enter.ng-enter-active,
    .animate-user.ng-leave {
        -webkit-transform: rotateX(0deg) translatez(30px);
        -moz-transform: rotateX(0deg) translatez(30px);
        -ms-transform: rotateX(0deg) translatez(30px);
        -o-transform: rotateX(0deg) translatez(30px);
        transform: rotateX(0deg) translatez(30px);
        opacity: 1;
        height: 30px;
    }
</style>